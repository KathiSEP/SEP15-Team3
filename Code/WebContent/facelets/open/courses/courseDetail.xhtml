<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://xmlns.jcp.org/jsf/passthrough">
	<ui:composition template="/WEB-INF/template.xhtml">
		<ui:define name="title"><h:outputText value="#{courseDetailBean.getCourse().title}"/></ui:define>
		<body>
			<ui:define name="content">
				<h1>Kursdetails</h1>
				<div class="row">
					<div class="col-lg-12">
						<p style="font-size:16px;">Hier finden Sie alle Informationen zum Kurs <strong>#{courseDetailBean.getCourse().title}</strong>:</p>
					</div>
				</div>
				<h:form id="test">
				<div class="row" style="padding-top:20px;">
					<div class="col-lg-5">
						<div class="panel panel-info">
							<div class="panel-heading"><strong>Details</strong></div>
							<div class="panel-body">
								<div class="input-group">
									<span class="input-group-addon" style="width:160px; text-align:right;"><strong>Kurs-ID:</strong></span>
									<h:inputText class="form-control" readonly="true" style="width:170px;" id="idCourse" value="#{courseDetailBean.courseID}"/>
								</div>
								<div class="input-group" style="padding-top:5px;">
									<span class="input-group-addon" style="width:160px; text-align:right;"><strong>Max. Teilnehmer:</strong></span>
									<h:inputText class="form-control" id="minPersonsCourse" readonly="#{!courseDetailBean.editMode}" value="#{courseDetailBean.course.maxUsers}"/>
								</div>
								<div class="input-group" style="padding-top:5px;">
									<span class="input-group-addon" style="width:160px; text-align:right;"><strong>Startdatum:</strong></span>
									<h:inputText class="form-control" id="startDateCourse" readonly="#{!courseDetailBean.editMode}" value="#{courseDetailBean.course.startdate}">
                                    	<f:convertDateTime pattern="dd.MM.yyyy"/>
									</h:inputText>
								</div>
								<div class="input-group" style="padding-top:5px;">
									<span class="input-group-addon" style="width:160px; text-align:right;"><strong>Enddatum:</strong></span>
									<h:inputText class="form-control" id="endDateCourse" readonly="#{!courseDetailBean.editMode}" value="#{courseDetailBean.course.enddate}">
                                    	<f:convertDateTime pattern="dd.MM.yyyy"/>
                                    </h:inputText>
								</div>
							</div>
						</div>
						<div class="panel panel-info">
							<div class="panel-heading"><strong>Kursleiter</strong></div>
							<div class="panel-body">
								<h:dataTable value="#{courseDetailBean.leadersOfCourse}" var="user" class="table table-hover">
									<h:column>
		                            	<f:facet name="header">Name</f:facet>
		                                <h:outputText value="#{user.lastname}"/>
		                            </h:column>
		                            <h:column>
		                            	<f:facet name="header">Vorname</f:facet>
		                            	<h:outputText value="#{user.firstname}"/>
		                            </h:column>
           							<h:column>
                		            	<f:facet name="header">E-Mail</f:facet>
                        		        <h:outputText value="#{user.email}"/>
                            		</h:column>
   		                            <h:column>
           			                    <f:facet name="header" />
                    		            <h:commandButton id="details" class="btn btn-alert" value="Löschen" action="#">
                            	        	<f:param name="" value=""/>
                                		</h:commandButton>
                            		</h:column>
								</h:dataTable>						
							</div>
						</div>
					</div>
					<div class="col-lg-7">
						<div class="panel panel-info">
							<div class="panel-heading"><strong>Beschreibung</strong></div>
							<div class="panel-body">
								<div class="row" style="text-align:center;"></div>
								<div class="row" style="padding-top:12px;">
									<div class="col-lg-12">
										<h:inputText class="form-control" rendered="#{courseDetailBean.editMode}" value="#{courseDetailBean.course.description}"/>
										<h:outputText rendered="#{!courseDetailBean.editMode}" value="#{courseDetailBean.course.description}"/>
									</div>
								</div>
							</div>
						</div>
						<h:panelGroup rendered="#{(courseDetailBean.sessionUser.userRole == 'REGISTERED_USER' || courseDetailBean.sessionUser.userRole == 'COURSE_LEADER'  || courseDetailBean.sessionUser.userRole == 'SYSTEM_ADMINISTRATOR')}">
							<div class="panel panel-info">
								<div class="panel-heading"><strong>Verwaltung</strong></div>
								<div class="panel-body">
									<h:panelGroup rendered="#{(courseDetailBean.sessionUser.userRole == 'COURSE_LEADER'  || courseDetailBean.sessionUser.userRole == 'SYSTEM_ADMINISTRATOR')}">
									<h:commandButton class="btn btn-warning" value="Bearbeiten" rendered="#{!courseDetailBean.editMode}" action="#{courseDetailBean.enableEditMode}"/>
									<h:commandButton class="btn btn-success" value="Speichern" rendered="#{courseDetailBean.editMode}" action="#{courseDetailBean.saveCourse}"/>
									<h:commandButton class="btn btn-success" value="Kurseinheit anlegen" rendered="#{(courseDetailBean.sessionUser.userRole == 'COURSE_LEADER'  || courseDetailBean.sessionUser.userRole == 'SYSTEM_ADMINISTRATOR')}"
														action="#{courseDetailBean.loadCreateCourseUnitPage}">
									<f:param name="editMode" value="false"/>
									<f:param name="courseID" value="#{courseDetailBean.course.courseID}"/>
									</h:commandButton>
									</h:panelGroup>
									<h:commandButton class="btn btn-success" value="Zum Kurs anmelden" rendered="#{!courseDetailBean.isRegistered}" action="#{courseDetailBean.signUpForCourse}"/>
									<h:commandButton class="btn btn-danger" value="Vom Kurs abmelden" rendered="#{courseDetailBean.isRegistered}" action="#{courseDetailBean.signOffFromCourse}"/>
								</div>
							</div>
						</h:panelGroup>
					</div>
				</div>
				</h:form>
				<div class="panel panel-info">
					<div class="panel-heading"><strong>Kurseinheiten</strong></div>
					<div class="panel-body">
						<h:dataTable value="#{courseDetailBean.courseUnitsOfCourse}" var="courseUnit" class="table table-hover">
							<h:column>
                            	<f:facet name="header">Startdatum</f:facet>
                                <h:outputText value="#{courseUnit.startime}">
                                    <f:convertDateTime pattern="dd.MM.yyyy"/>
                                </h:outputText> 
                            </h:column>
                            <h:column>
                           		<f:facet name="header">Uhrzeit</f:facet>
                                <h:outputText value="#{courseUnit.startime}">
                                    <f:convertDateTime pattern="HH:mm"/>
                                </h:outputText>
                            </h:column>
                            <h:column>
                            	<f:facet name="header">Endzeitpunkt</f:facet>
                            	<h:outputText value="#{courseUnit.endtime}"/>
                            </h:column>
                            <h:column>
                            	<f:facet name="header">Beschreibung</f:facet>
                            	<h:outputText value="#{courseUnit.description}"/>
                            </h:column>
                            <h:column>
                            	<f:facet name="header">Status</f:facet>
                            	<h:outputText class="badge" value="#{courseUnit.numberOfUsers}/#{courseUnit.maxUsers}"/>
                            </h:column>
                            <h:column>
                            	<f:facet name="header">Ort</f:facet>
                            	<h:outputText value="#{courseUnit.address.location}"/>
                            </h:column>
                            <h:column>
                            	<f:facet name="header">Preis</f:facet>
                            	<h:outputText class="badge" value="#{courseUnit.price}€"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header"/>
       	                        <h:form>
   	    	                        <h:commandButton id="details" class="btn btn-success" value="Anmelden" action="#{courseDetailBean.signUpForCourseUnits}">
            	                        <f:param name="courseUnitID" value="#{courseUnit.courseUnitID}"/>
                   	            	</h:commandButton>
                       	        </h:form>
                            </h:column>
                            <h:column>
                                <f:facet name="header"/>
       	                        <h:form>
   	    	                        <h:commandButton id="bearbeiten" class="btn btn-warning" value="Bearbeiten" action="#{courseDetailBean.loadEditCourseUnitPage}"
   	    	                        				rendered="#{(courseDetailBean.sessionUser.userRole == 'COURSE_LEADER'  || courseDetailBean.sessionUser.userRole == 'SYSTEM_ADMINISTRATOR')}">
   	    	                        	<f:param name="editMode" value="true"/>
            	                        <f:param name="courseUnitID" value="#{courseUnit.courseUnitID}"/>
            	                        <f:param name="courseID" value="#{courseDetailBean.course.courseID}"/>
                   	            	</h:commandButton>
                       	        </h:form>
                            </h:column>
						</h:dataTable>
					</div>
				</div>
			</ui:define>
		</body>
	</ui:composition>
</html>